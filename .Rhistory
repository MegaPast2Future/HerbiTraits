herbiTraits_Master[which(herbiTraits_Master$Binomial == "Dicroceros_spA"),"Mass.Notes"] = "Comparison species is Candiacervus cretensis"
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Hexaprotodon_sivalensis"),"Mass.Notes"] = "Comparison species is Hexaprotodon coryndoni"
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Hystrix_refossa"),"Mass.Notes"] = "Comparison species is Hystrix javanica"
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Megatherium_tarijense"),"Mass.Notes"] = "Bone measurement not specified. Comparison species is Megatherium americanum"
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Muntiacus_rooseveltorum"),"Mass.Notes"] = "Comparison species is Muntiacus truongsonensis"
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Palaeolama_major"),"Mass.Notes"] = "Presumably mandible length, though the measurment is not specified. Comparison species is Hemiauchenia paradoxa"
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Palaeolama_weddeli"),"Mass.Notes"] = "Presumably mandible length, though the measurment is not specified. Comparison species is Hemiauchenia paradoxa"
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Scelidodon_chiliensis"),"Mass.Notes"] = "Bone measurement not specified. Comparison species is Scelidotherium leptocephalum"
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Sus_ahoenobarbus"),"Mass.Notes"] = "Comparison species is Sus barbatus"
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Sus_oliveri"),"Mass.Notes"] = "Comparison species is Sus cebifrons"
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Sus_philippensis"),"Mass.Notes"] = "Comparison species is Sus cebifrons"
## Remove the _ again and replace them with spaces
#–––––––––––––––––––––––––––––––––––––––––––––––––––––––––––
herbiTraits_Master$Binomial = gsub("_", " ", herbiTraits_Master$Binomial)
#–––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––####
##### 9. QUALITY CONTROL #####
#–––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––####
str(herbiTraits_Master)
herbiTraits_Mammals = herbiTraits_Master[which(herbiTraits_Master$Class == "Mammalia"),]
## Sources
reference_list = unique(unlist(strsplit(herbiTraits_Mammals$Mass.Reference, split = "; "))) # Number of Sources
length(reference_list) # Number of Sources
sort(reference_list)
## Methods
sort(unique(herbiTraits_Mammals$Mass.Method))
length(unique(herbiTraits_Mammals$Mass.Method))
## Notes
# herbiTraits_Master[which(herbiTraits_Mammals$Mass.Notes == ""),"Mass.Notes"] = NA
# herbiTraits_Mammals$Mass.Notes
##  any NA's'
any(is.na(herbiTraits_Mammals$Mass.g))
any(is.na(herbiTraits_Mammals$Mass.Method))
any(is.na(herbiTraits_Mammals$Mass.Method.Reliability))
any(is.na(herbiTraits_Mammals$Mass.Notes))
any(is.na(herbiTraits_Mammals$Mass.Reference))
#temp = herbiTraits_Master[,c("Binomial", "Mass.g", "Mass.Method", "Mass.Method.Reliability", "Mass.Notes", "Mass.Reference")]
#–––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––####
##### 8. SAVE THE DATA #####
#–––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––####
## Create filename
date = as.Date(Sys.time()) # Create Date
date = gsub("-","_",date)
filename = paste("./HerbiTraits_2020_10_01/Changes/3_Output/HerbiTraits_S1_",date,".csv", sep ="") #Create filename
## Save
write.csv(herbiTraits_Master, file = filename)
######################################################################!
#                                                                    #
#      Script 2: ADDING MASS METADATA OF BIRDS TO HERBITRAITS        #
#      (5/10/2020)                                                   #
######################################################################!
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
# METADATA
# This script adds mass metdata to the herbitraits dataset
#
# Output: an updated dataframe with mass and mass metadata, in the form of a csv file
# time: less than 1 min
# Status: under construction (14 September 2020)
#
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
#–––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––####
##### 1. PREPARING THE DATA #####
#–––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––####
# – Clear Memory ####
#–––––––––––––––––––––––––––––––––––––––––––––––––––––––––––
rm(list = ls())  # clean memory (= remove)
graphics.off()  # close graphic windows
# – Set working directory ####
#–––––––––––––––––––––––––––––––––––––––––––––––––––––––––––
setwd("/Users/au572919/Research/herbiTraits")
getwd()
# – Set up libraries ####
#–––––––––––––––––––––––––––––––––––––––––––––––––––––––––––
# library(gdata) # to read excel files
# – Load Data ####
#–––––––––––––––––––––––––––––––––––––––––––––––––––––––––––
## Locate all trait datasets that S0 created.
files_in_folder = list.files(path = "./HerbiTraits_2020_10_01/Changes/3_Output") # list all the files occurring is the folder
Trait_Datasets = files_in_folder[which(grepl(pattern = "HerbiTraits_S1_",files_in_folder, fixed = TRUE))] # take all the Bird Trait Files
## Select the most recent version of the datasets
Trait_Datasets = tail(sort(Trait_Datasets), n=1)
## Load HerbiTraits Data
herbiTraits_Master = read.csv(paste("./HerbiTraits_2020_10_01/Changes/3_Output/", Trait_Datasets, sep =""))
herbiTraits_Master[1:10,1:10]
dim(herbiTraits_Master)
#–––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––####
##### 2. ADD METADATA  #####
#–––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––####
herbiTraits_Master$Mass.Method = as.character(herbiTraits_Master$Mass.Method)
herbiTraits_Master$Mass.Reference = as.character(herbiTraits_Master$Mass.Reference)
herbiTraits_Master$Mass.Notes = as.character(herbiTraits_Master$Mass.Notes)
colnames(herbiTraits_Master)
str(herbiTraits_Master)
table(herbiTraits_Master$Mass.Reference)
## Hansford and Turvey (2018)
#–––––––––––––––––––––––––––––––––––––––––––––––––––––––
# Aepyornis hildebrandti
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Aepyornis hildebrandti"),"Mass.g"] = 283.15 * 1000
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Aepyornis hildebrandti"),"Mass.Method"] = "Regression (femur least-shaft circumference)" #Allometric
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Aepyornis hildebrandti"),"Mass.Method.Reliability"] = 2
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Aepyornis hildebrandti"),"Mass.Reference"] = "Hansford and Turvey 2018 Royal Society Open Science"
# Aepyornis maximus
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Aepyornis maximus"),"Mass.g"] = 409.5 * 1000
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Aepyornis maximus"),"Mass.Method"] = "Regression (femur least-shaft circumference)" #Allometric
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Aepyornis maximus"),"Mass.Method.Reliability"] = 2
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Aepyornis maximus"),"Mass.Reference"] = "Hansford and Turvey 2018 Royal Society Open Science"
# Mullerornis modestus
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Mullerornis modestus"),"Mass.g"] = 107.7 * 1000
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Mullerornis modestus"),"Mass.Method"] = "Regression (femur least-shaft circumference)" #Allometric
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Mullerornis modestus"),"Mass.Method.Reliability"] = 2
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Mullerornis modestus"),"Mass.Reference"] = "Hansford and Turvey 2018 Royal Society Open Science"
# Vorombe titan
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Vorombe titan"),"Mass.g"] = 642.9 * 1000
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Vorombe titan"),"Mass.Method"] = "Regression (femur least-shaft circumference)" #Allometric
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Vorombe titan"),"Mass.Method.Reliability"] = 2
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Vorombe titan"),"Mass.Reference"] = "Hansford and Turvey 2018 Royal Society Open Science"
# Allometric
## Worthy and Holdaway (2002)
#–––––––––––––––––––––––––––––––––––––––––––––––––––––––
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Cnemiornis calcitrans"),"Mass.g"] = 17.46 * 1000
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Cnemiornis calcitrans"),"Mass.Method"] = "Regression (femur diameter)" #Allometric
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Cnemiornis calcitrans"),"Mass.Method.Reliability"] = 2
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Cnemiornis calcitrans"),"Mass.Reference"] = "Worthy and Holdaway 2002 The lost world of the moa: prehistoric life of New Zealand"
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Cnemiornis gracilis"),"Mass.g"] = 12.18 * 1000
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Cnemiornis gracilis"),"Mass.Method"] = "Regression (femur diameter)" #Allometric
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Cnemiornis gracilis"),"Mass.Method.Reliability"] = 2
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Cnemiornis gracilis"),"Mass.Reference"] = "Worthy and Holdaway 2002 The lost world of the moa: prehistoric life of New Zealand"
## Northcote (1982)
#–––––––––––––––––––––––––––––––––––––––––––––––––––––––
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Cygnus falconeri"),"Mass.g"] = 16.38 * 1000
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Cygnus falconeri"),"Mass.Method"] = "Regression (tarsometatarsus width)"
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Cygnus falconeri"),"Mass.Method.Reliability"] = 2
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Cygnus falconeri"),"Mass.Reference"] = "Northcote 1982 Ibis"
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Cygnus falconeri"),"Mass.Notes"] = "This mass estimates assumes that Cygnus falconeri was elastically similar to Cygnus cygnus."
## van Heteren et al. (2017)
#–––––––––––––––––––––––––––––––––––––––––––––––––––––––
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Raphus cucullatus"),"Mass.g"] = 12.4 * 1000
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Raphus cucullatus"),"Mass.Method"] = "Regression (femur mid-shaft circumference)"
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Raphus cucullatus"),"Mass.Method.Reliability"] = 2
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Raphus cucullatus"),"Mass.Reference"] = "Van Heteren et al. 2017 PeerJ"
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Raphus cucullatus"),"Mass.Notes"] = "This estimate is based on a sample of 174 femora of Raphus cucullatus."
## Olson and Turvey (2013)
#–––––––––––––––––––––––––––––––––––––––––––––––––––––––
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Dinornis novaezealandiae"),"Mass.g"] = (56600 + 111976) / 2
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Dinornis novaezealandiae"),"Mass.Method"] = "Regression (femur length)"
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Dinornis novaezealandiae"),"Mass.Method.Reliability"] = 2
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Dinornis novaezealandiae"),"Mass.Reference"] = "Olson and Turvey 2013 Proceedings of the Royal Society B"
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Dinornis novaezealandiae"),"Mass.Notes"] = "The species possessed strong sexual dimorphism. The value is the mean of the median male (56.6 kg) and female (111.976 kg) body mass."
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Dinornis robustus"),"Mass.g"] = (80333 + 151723) / 2
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Dinornis robustus"),"Mass.Method"] = "Regression (femur length)"
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Dinornis robustus"),"Mass.Method.Reliability"] = 2
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Dinornis robustus"),"Mass.Reference"] = "Olson and Turvey 2013 Proceedings of the Royal Society B"
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Dinornis robustus"),"Mass.Notes"] = "The species possessed strong sexual dimorphism. The value is the mean of the median male (80.333 kg) and female (151.723 kg) body mass."
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Euryapteryx curtus"),"Mass.g"] =  (17200 + 28100) / 2
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Euryapteryx curtus"),"Mass.Method"] = "Regression (femur length)"
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Euryapteryx curtus"),"Mass.Method.Reliability"] = 2
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Euryapteryx curtus"),"Mass.Reference"] = "Olson and Turvey 2013 Proceedings of the Royal Society B"
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Euryapteryx curtus"),"Mass.Notes"] = "The species possessed strong sexual dimorphism. The value is the mean of the median male (17.2 kg) and female (28.1 kg) body mass. "
## Latham (2020)
#–––––––––––––––––––––––––––––––––––––––––––––––––––––––
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Anomalopteryx didiformis"),"Mass.g"] =  43720
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Anomalopteryx didiformis"),"Mass.Method"] = "Regression (femur length)"
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Anomalopteryx didiformis"),"Mass.Method.Reliability"] = 2
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Anomalopteryx didiformis"),"Mass.Reference"] = "Latham et al. 2020 Ecography"
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Emeus crassus"),"Mass.g"] = 55970
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Emeus crassus"),"Mass.Method"] = "Regression (femur length)"
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Emeus crassus"),"Mass.Method.Reliability"] = 2
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Emeus crassus"),"Mass.Reference"] = "Latham et al. 2020 Ecography"
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Pachyornis australis"),"Mass.g"] =  65310
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Pachyornis australis"),"Mass.Method"] = "Regression (femur length)"
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Pachyornis australis"),"Mass.Method.Reliability"] = 2
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Pachyornis australis"),"Mass.Reference"] = "Latham et al. 2020 Ecography"
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Pachyornis elephantopus"),"Mass.g"] =  74680
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Pachyornis elephantopus"),"Mass.Method"] = "Regression (femur length)"
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Pachyornis elephantopus"),"Mass.Method.Reliability"] = 2
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Pachyornis elephantopus"),"Mass.Reference"] = "Latham et al. 2020 Ecography"
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Pachyornis geranoides"),"Mass.g"] =  26170
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Pachyornis geranoides"),"Mass.Method"] = "Regression (femur length)"
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Pachyornis geranoides"),"Mass.Method.Reliability"] = 2
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Pachyornis geranoides"),"Mass.Reference"] = "Latham et al. 2020 Ecography"
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Megalapteryx didinus"),"Mass.g"] =  42430
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Megalapteryx didinus"),"Mass.Method"] = "Regression (femur length)"
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Megalapteryx didinus"),"Mass.Method.Reliability"] = 2
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Megalapteryx didinus"),"Mass.Reference"] = "Latham et al. 2020 Ecography"
## Murray and Vickers-Rich (2004)
#–––––––––––––––––––––––––––––––––––––––––––––––––––––––
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Genyornis newtoni"),"Mass.g"] = 275 * 1000
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Genyornis newtoni"),"Mass.Method"] = "Expert opinion"
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Genyornis newtoni"),"Mass.Method.Reliability"] = 0
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Genyornis newtoni"),"Mass.Reference"] = "Murray and Vickers-Rich 2004 Magnificent mihirungs: the colossal flightless birds of the Australian dreamtime"
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Genyornis newtoni"),"Mass.Notes"] = "The authors explicitely say the mass estimates are 'not derived from any particular formulations or calculations'. Instead, they likely represent rough guesses."
## Worthy et al. (2016)
#–––––––––––––––––––––––––––––––––––––––––––––––––––––––
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Sylviornis neocaledoniae"),"Mass.g"] = (34.4 + 34.1)/2 * 1000
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Sylviornis neocaledoniae"),"Mass.Method"] = "Regression (femur mid-shaft circumference)"
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Sylviornis neocaledoniae"),"Mass.Method.Reliability"] = 2
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Sylviornis neocaledoniae"),"Mass.Reference"] = "HerbiTraits; Worthy et al. 2016 PLoS One"
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Sylviornis neocaledoniae"),"Mass.Notes"] = "Estimate is the mean of the two mean values provided in the study using two different regressions. The sample on which these estimates are based consists of five specimens"
## Lundgren et al. (2020) --> HerbiTraits
#–––––––––––––––––––––––––––––––––––––––––––––––––––––––
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Struthio asiaticus"),"Mass.g"] = 111 * 1000
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Struthio asiaticus"),"Mass.Method"] = "As relative of suggested similar size"
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Struthio asiaticus"),"Mass.Method.Reliability"] = 0
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Struthio asiaticus"),"Mass.Reference"] = "HerbiTraits"
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Struthio asiaticus"),"Mass.Notes"] = "We assume its size was similar to that of Struthio camelus"
## Davids 2011 Thesis
#–––––––––––––––––––––––––––––––––––––––––––––––––––––––
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Struthio molybdophanes"),"Mass.g"] = 105 * 1000
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Struthio molybdophanes"),"Mass.Method"] = "Expert opinion"
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Struthio molybdophanes"),"Mass.Method.Reliability"] = 0
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Struthio molybdophanes"),"Mass.Reference"] = "Davids 2011 Thesis"
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Struthio molybdophanes"),"Mass.Notes"] = "Similar sized to S. camelus, but trending slightly smaller. In domestic conditions average at 105 kg. The source provides no reference."
# No source in reference list --> Extant species. We write exant species and not "observed" because we have no metadata. It is just a number thrown around.
## Yates and Worthy (2019)
#–––––––––––––––––––––––––––––––––––––––––––––––––––––––
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Dromaius baudinianus"),"Mass.g"] = 25.06 * 1000
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Dromaius baudinianus"),"Mass.Method"] = "Regression (femur least-shaft circumference)"
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Dromaius baudinianus"),"Mass.Method.Reliability"] = 2
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Dromaius baudinianus"),"Mass.Reference"] = "Yates and Worthy 2019 Journal of Vertebrate Paleontology"
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Dromaius minor"),"Mass.g"] = 18.63 * 1000
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Dromaius minor"),"Mass.Method"] = "Regression (femur least-shaft circumference)"
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Dromaius minor"),"Mass.Method.Reliability"] = 2
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Dromaius minor"),"Mass.Reference"] = "Yates and Worthy 2019 Journal of Vertebrate Paleontology"
##  Livezey (1993)
#–––––––––––––––––––––––––––––––––––––––––––––––––––––––
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Pezophaps solitaria"),"Mass.g"] = ((27.8 + 17.4) / 2) * 1000
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Pezophaps solitaria"),"Mass.Method"] = "Regression (femur length)"
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Pezophaps solitaria"),"Mass.Method.Reliability"] = 2
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Pezophaps solitaria"),"Mass.Reference"] = "Livezey 1993 Journal of Zoology"
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Pezophaps solitaria"),"Mass.Notes"] = "The estimate is the mean of male (27.8 kg) and female (17.4 kg) body size"
## Worthy 2001
#–––––––––––––––––––––––––––––––––––––––––––––––––––––––
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Natunaornis gigoura"),"Mass.g"] = 12 * 1000
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Natunaornis gigoura"),"Mass.Method"] = "As relative of suggested similar size"
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Natunaornis gigoura"),"Mass.Method.Reliability"] = 0
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Natunaornis gigoura"),"Mass.Reference"] = "HerbiTraits; Worthy 2001 Journal of the Royal Society of New Zealand"
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Natunaornis gigoura"),"Mass.Notes"] = "Worthy 2001 says Natunaornis gigoura is slightly smaller than Raphus cucullatus (HerbiTraits Estimate: 12.4 kg). Based on this we estimated that the mass of Natunaornis gigoura is 12 kg. We did not find precise mass estimates"
## Wilman et al. 2014
#–––––––––––––––––––––––––––––––––––––––––––––––––––––––
#https://books.google.dk/books?id=TcnOTPILlcEC&printsec=frontcover&hl=fr&source=gbs_ge_summary_r&cad=0#v=snippet&q=Cygnus&f=false
# Cygnus buccinator (extant)
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Cygnus buccinator"),"Mass.g"] = 11.07 * 1000
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Cygnus buccinator"),"Mass.Method"] = "Method unknown"
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Cygnus buccinator"),"Mass.Method.Reliability"] = 0
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Cygnus buccinator"),"Mass.Reference"] = "Wilman et al. 2014 Ecology; Dunning 2008 CRC Handbook of Avian Body Masses"
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Cygnus buccinator"),"Mass.Notes"] = "Primary source inaccessible"
# herbiTraits_Master[which(herbiTraits_Master$Binomial == "Cygnus buccinator"),"Mass.Notes"] = "The primary source for this mass estimate is Dunning 2008 CRC Handbook of Avian Body Masses. This book is a collection of published literature about bird masses. They are not"
# CRC Handbook of Avian body masses, Geometric mean of average values provided for both sexes
# Cygnus olor (extant)
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Cygnus olor"),"Mass.g"] = 10.68 * 1000
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Cygnus olor"),"Mass.Method"] = "Method unknown"
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Cygnus olor"),"Mass.Method.Reliability"] = 0
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Cygnus olor"),"Mass.Reference"] = "Wilman et al. 2014 Ecology; Dunning 2008 CRC Handbook of Avian Body Masses"
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Cygnus olor"),"Mass.Notes"] = "Primary source inaccessible"
# CRC Handbook of Avian body masses,  Geometric mean of average values provided for both sexes
# Dromaius novaehollandiae (extant)
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Dromaius novaehollandiae"),"Mass.g"] = (31500 + 36900) / 2
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Dromaius novaehollandiae"),"Mass.Method"] = "Observed"
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Dromaius novaehollandiae"),"Mass.Method.Reliability"] = 3
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Dromaius novaehollandiae"),"Mass.Reference"] = "Wilman et al. 2014 Ecology; Dunning 2008 CRC Handbook of Avian Body Masses"
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Dromaius novaehollandiae"),"Mass.Notes"] = "This estimate is based the average of the male and female body size. Both the male and female mass estimate are based on 11 specimens. We collected this value from Dunning 2008 CRC Handbook of Avian Body Masses. This book is a collection of published literature about bird masses and is not the primary source of these estimates."
# CRC Handbook of Avian body masses,  Geometric mean of average values provided for both sexes
# Rhea pennata (extant)
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Rhea pennata"),"Mass.g"] = 23.9 * 1000
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Rhea pennata"),"Mass.Method"] = "Observed"
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Rhea pennata"),"Mass.Method.Reliability"] = 3
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Rhea pennata"),"Mass.Reference"] = "Wilman et al. 2014 Ecology; Dunning 2008 CRC Handbook of Avian Body Masses"
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Rhea pennata"),"Mass.Notes"] = "This estimate is based on three male specimens. We collected this value from Dunning 2008 CRC Handbook of Avian Body Masses. This book is a collection of published literature about bird masses and is not the primary source of these estimates."
# CRC Handbook of Avian body masses,  Geometric mean of average values provided for both sexes
# Rhea americana (extant)
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Rhea americana"),"Mass.g"] = 23 * 1000
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Rhea americana"),"Mass.Method"] = "Expert opinion"
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Rhea americana"),"Mass.Method.Reliability"] = 0
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Rhea americana"),"Mass.Reference"] = "Wilman et al. 2014 Ecology; Dunning 2008 CRC Handbook of Avian Body Masses"
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Rhea americana"),"Mass.Notes"] = "This estimate is based on an unknown number of individuals of unknown sex. We collected this value from Dunning 2008 CRC Handbook of Avian Body Masses. This book is a collection of published literature about bird masses and is not the primary source of these estimates."
# CRC Handbook of Avian body masses,  Geometric mean of average values provided for both sexes
# Casuarius bennetti (extant)
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Casuarius bennetti"),"Mass.g"] = 35 * 1000
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Casuarius bennetti"),"Mass.Method"] = "Expert opinion"
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Casuarius bennetti"),"Mass.Method.Reliability"] = 0
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Casuarius bennetti"),"Mass.Reference"] = "Wilman et al. 2014 Ecology; Dunning 2008 CRC Handbook of Avian Body Masses"
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Casuarius bennetti"),"Mass.Notes"] = "This estimate is based on an unknown number of individuals of unknown sex. We collected this value from Dunning 2008 CRC Handbook of Avian Body Masses. This book is a collection of published literature about bird masses and is not the primary source of these estimates."
# CRC Handbook of Avian body masses,  Geometric mean of average values provided for both sexes
# Casuarius casuarius (extant)
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Casuarius casuarius"),"Mass.g"] = 44 * 1000
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Casuarius casuarius"),"Mass.Method"] = "Observed"
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Casuarius casuarius"),"Mass.Method.Reliability"] = 3
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Casuarius casuarius"),"Mass.Reference"] = "Wilman et al. 2014 Ecology; Dunning 2008 CRC Handbook of Avian Body Masses"
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Casuarius casuarius"),"Mass.Notes"] = "This estimate is based on an unknown number of individuals of both sexes. We collected this value from Dunning 2008 CRC Handbook of Avian Body Masses. This book is a collection of published literature about bird masses and is not the primary source of these estimates."
# CRC Handbook of Avian body masses,  Geometric mean of average values provided for both sexes
# Casuarius unappendiculatus (extant)
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Casuarius unappendiculatus"),"Mass.g"] = ((36600 + 58000)/2)
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Casuarius unappendiculatus"),"Mass.Method"] = "Observed"
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Casuarius unappendiculatus"),"Mass.Method.Reliability"] = 3
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Casuarius unappendiculatus"),"Mass.Reference"] = "Wilman et al. 2014 Ecology; Dunning 2008 CRC Handbook of Avian Body Masses"
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Casuarius unappendiculatus"),"Mass.Notes"] = "This estimate is based the average of the male and female body size. The male mass estimate is based on an unknown number of individuals. The female mass estimate is based on one individual. We collected this value from Dunning 2008 CRC Handbook of Avian Body Masses. This book is a collection of published literature about bird masses and is not the primary source of these estimates."
# Struthio camelus (extant)
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Struthio camelus"),"Mass.g"] = 111 * 1000
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Struthio camelus"),"Mass.Method"] = "Observed"
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Struthio camelus"),"Mass.Method.Reliability"] = 3
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Struthio camelus"),"Mass.Reference"] = "Wilman et al. 2014 Ecology; Dunning 2008 CRC Handbook of Avian Body Masses"
herbiTraits_Master[which(herbiTraits_Master$Binomial == "Struthio camelus"),"Mass.Notes"] = "This estimate is based on 13 individuals of unknown sex. We collected this value from Dunning 2008 CRC Handbook of Avian Body Masses. This book is a collection of published literature about bird masses and is not the primary source of these estimates."
#–––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––####
##### 3. QUALITY CONTROL BIRDS #####
#–––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––####
str(herbiTraits_Master)
herbiTraits_birds = herbiTraits_Master[which(herbiTraits_Master$Class == "Aves"),]
## Sources
reference_list = unique(unlist(strsplit(herbiTraits_birds$Mass.Reference, split = "; "))) # Number of Sources
length(reference_list) # Number of Sources
sort(reference_list)
## Methods
sort(unique(herbiTraits_birds$Mass.Method))
length(unique(herbiTraits_birds$Mass.Method))
## Notes
# herbiTraits_birds[which(herbiTraits_birds$Mass.Notes == ""),"Mass.Notes"] = NA
# herbiTraits_birds$Mass.Notes
##  any NA's'
any(is.na(herbiTraits_birds$Mass.g))
any(is.na(herbiTraits_birds$Mass.Method))
any(is.na(herbiTraits_birds$Mass.Method.Reliability))
any(is.na(herbiTraits_birds$Mass.Notes))
any(is.na(herbiTraits_birds$Mass.Reference))
#–––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––####
##### 9. QUALITY CONTROL ALL #####
#–––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––####
str(herbiTraits_Master)
## Sources
reference_list = unique(unlist(strsplit(herbiTraits_Master$Mass.Reference, split = "; "))) # Number of Sources
length(reference_list) # Number of Sources
sort(reference_list)
## Methods
sort(unique(herbiTraits_Master$Mass.Method))
length(unique(herbiTraits_Master$Mass.Method))
## Notes
# herbiTraits_Master[which(herbiTraits_Master$Mass.Notes == ""),"Mass.Notes"] = NA
# herbiTraits_Master$Mass.Notes
##  any NA's'
any(is.na(herbiTraits_Master$Mass.g))
any(is.na(herbiTraits_Master$Mass.Method))
any(is.na(herbiTraits_Master$Mass.Method.Reliability))
any(is.na(herbiTraits_Master$Mass.Notes))
any(is.na(herbiTraits_Master$Mass.Reference))
#temp = herbiTraits_Master[,c("Binomial", "Mass.g", "Mass.Method", "Mass.Method.Reliability", "Mass.Notes", "Mass.Reference")]
#–––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––####
##### 4. SAVE THE DATA #####
#–––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––####
## Create filename
date = as.Date(Sys.time()) # Create Date
date = gsub("-","_",date)
filename = paste("./HerbiTraits_2020_10_01/Changes/3_Output/HerbiTraits_S2_",date,".csv", sep ="") #Create filename
## Save
write.csv(herbiTraits_Master, file = filename)
######################################################################!
#                                                                    #
#      Script 3: CHECK THE MASS METADATA                              #
#                                                                    #
######################################################################!
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
# METADATA
# This script checks the references
#
# Output: an updated dataframe with cleaned up references in the form of a csv file. Also an excel file for further processing
# time: less than 1 min
# Status: under construction (23 September 2020)
#
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
#–––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––####
##### 1. PREPARING THE DATA #####
#–––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––####
# – Clear Memory ####
#–––––––––––––––––––––––––––––––––––––––––––––––––––––––––––
rm(list = ls())  # clean memory (= remove)
graphics.off()  # close graphic windows
# – Set working directory ####
#–––––––––––––––––––––––––––––––––––––––––––––––––––––––––––
setwd("/Users/au572919/Research/herbiTraits")
getwd()
# – Set up libraries ####
#–––––––––––––––––––––––––––––––––––––––––––––––––––––––––––
# – Load Data ####
#–––––––––––––––––––––––––––––––––––––––––––––––––––––––––––
#~~ EXPLANATION ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
#
#  This script combines the csv files created by S1 and S2. These CSV files have their creation date in their name to keep track of the most recent version.
#  This means there may be many trait files in the output folder. The following lines of code just select the most recent trait dataset, based on the creation date in the filename.
#
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
## Locate all trait datasets that S2 created.
files_in_folder = list.files(path = "./HerbiTraits_2020_10_01/Changes/3_Output") # list all the files occurring is the folder
Trait_Datasets = files_in_folder[which(grepl(pattern = "HerbiTraits_S2_",files_in_folder, fixed = TRUE))] # take all the Bird Trait Files
## Select the most recent version of the datasets
Trait_Datasets = tail(sort(Trait_Datasets), n=1)
## Load HerbiTraits Data
herbiTraits_Master = read.csv(paste("./HerbiTraits_2020_10_01/Changes/3_Output/", Trait_Datasets, sep =""))
herbiTraits_Master[1:10,1:10]
dim(herbiTraits_Master)
## Remove unneccesary column
herbiTraits_Master = herbiTraits_Master[,which(!(colnames(herbiTraits_Master) %in% c("X", "X.1")))]
#–––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––####
##### 4. CORRECT REFERENCES #####
#–––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––####
## Select variables with references
variables.with.references = which(grepl(pattern = "Reference", colnames(herbiTraits_Master), fixed = TRUE))
colnames(herbiTraits_Master)[variables.with.references]
# – Make a reference list (short notation) ####
#–––––––––––––––––––––––––––––––––––––––––––––––––––––––––––
## Select all variables with References
references = herbiTraits_Master[,variables.with.references]
references = as.vector(as.matrix(references))
## Sources
references = unique(unlist(strsplit(references, split = "; "))) # Number of Sources
length(references) # Number of Sources
references = sort(references)
# references[1:50]
# references[51:100]
# references[101:150]
# references[151:200]
# references[201:250]
# references[251:300]
# references[301:350]
# references[351:400]
# references[401:450]
# references[451:500]
# references[501:550]
# references[551:600]
## Correct Typos and mistakes and make citation style consistent
#––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––
herbiTraits_Master$Mass.Reference = gsub(pattern = "All About Birds 2020 Cornell Lab of Ornithology ", replacement = "All About Birds 2020 Cornell Lab of Ornithology", x = herbiTraits_Master$Mass.Reference)
herbiTraits_Master$Diet.Reference = gsub(pattern = "All About Birds 2020 Cornell Lab of Ornithology ", replacement = "All About Birds 2020 Cornell Lab of Ornithology", x = herbiTraits_Master$Diet.Reference)
herbiTraits_Master$Fermentation.Type.Reference = gsub(pattern = "All About Birds 2020 Cornell Lab of Ornithology ", replacement = "All About Birds 2020 Cornell Lab of Ornithology", x = herbiTraits_Master$Fermentation.Type.Reference)
herbiTraits_Master$Limb.Morphology.Reference = gsub(pattern = "All About Birds 2020 Cornell Lab of Ornithology ", replacement = "All About Birds 2020 Cornell Lab of Ornithology", x = herbiTraits_Master$Limb.Morphology.Reference)
herbiTraits_Master$Habitat.Reference = gsub(pattern = "All About Birds 2020 Cornell Lab of Ornithology ", replacement = "All About Birds 2020 Cornell Lab of Ornithology", x = herbiTraits_Master$Habitat.Reference)
herbiTraits_Master$Mass.Reference = gsub(pattern = "Czerwonogora et al. 2011 Neues Jahrbuch f¸r Geologie und Pal‰ontologie-Abhandlungen", replacement = "Czerwonogora et al. 2011 Neues Jahrbuch fur Geologie und Paleontologie-Abhandlungen", x = herbiTraits_Master$Mass.Reference)
herbiTraits_Master$Diet.Reference = gsub(pattern = "Czerwonogora et al. 2011 Neues Jahrbuch f¸r Geologie und Pal‰ontologie-Abhandlungen", replacement = "Czerwonogora et al. 2011 Neues Jahrbuch fur Geologie und Paleontologie-Abhandlungen", x = herbiTraits_Master$Diet.Reference)
herbiTraits_Master$Fermentation.Type.Reference = gsub(pattern = "Czerwonogora et al. 2011 Neues Jahrbuch f¸r Geologie und Pal‰ontologie-Abhandlungen", replacement = "Czerwonogora et al. 2011 Neues Jahrbuch fur Geologie und Paleontologie-Abhandlungen", x = herbiTraits_Master$Fermentation.Type.Reference)
herbiTraits_Master$Limb.Morphology.Reference = gsub(pattern = "Czerwonogora et al. 2011 Neues Jahrbuch f¸r Geologie und Pal‰ontologie-Abhandlungen", replacement = "Czerwonogora et al. 2011 Neues Jahrbuch fur Geologie und Paleontologie-Abhandlungen", x = herbiTraits_Master$Limb.Morphology.Reference)
herbiTraits_Master$Habitat.Reference = gsub(pattern = "Czerwonogora et al. 2011 Neues Jahrbuch f¸r Geologie und Pal‰ontologie-Abhandlungen", replacement = "Czerwonogora et al. 2011 Neues Jahrbuch fur Geologie und Paleontologie-Abhandlungen", x = herbiTraits_Master$Habitat.Reference)
herbiTraits_Master$Mass.Reference = gsub(pattern = "Geist 1998 Stackpole books", replacement = "Geist 1998 Deer of the world: their evolution, behaviour, and ecology", x = herbiTraits_Master$Mass.Reference)
herbiTraits_Master$Diet.Reference = gsub(pattern = "Geist 1998 Stackpole books", replacement = "Geist 1998 Deer of the world: their evolution, behaviour, and ecology", x = herbiTraits_Master$Diet.Reference)
herbiTraits_Master$Fermentation.Type.Reference = gsub(pattern = "Geist 1998 Stackpole books", replacement = "Geist 1998 Deer of the world: their evolution, behaviour, and ecology", x = herbiTraits_Master$Fermentation.Type.Reference)
herbiTraits_Master$Limb.Morphology.Reference = gsub(pattern = "Geist 1998 Stackpole books", replacement = "Geist 1998 Deer of the world: their evolution, behaviour, and ecology", x = herbiTraits_Master$Limb.Morphology.Reference)
herbiTraits_Master$Habitat.Reference = gsub(pattern = "Geist 1998 Stackpole books", replacement = "Geist 1998 Deer of the world: their evolution, behaviour, and ecology", x = herbiTraits_Master$Habitat.Reference)
herbiTraits_Master$Mass.Reference = gsub(pattern = "Gillette and Ray 1981 Smithsonian Institution Press", replacement = "Gillette and Ray 1981 Glyptodonts of North America", x = herbiTraits_Master$Mass.Reference)
herbiTraits_Master$Diet.Reference = gsub(pattern = "Gillette and Ray 1981 Smithsonian Institution Press", replacement = "Gillette and Ray 1981 Glyptodonts of North America", x = herbiTraits_Master$Diet.Reference)
herbiTraits_Master$Fermentation.Type.Reference = gsub(pattern = "Gillette and Ray 1981 Smithsonian Institution Press", replacement = "Gillette and Ray 1981 Glyptodonts of North America", x = herbiTraits_Master$Fermentation.Type.Reference)
herbiTraits_Master$Limb.Morphology.Reference = gsub(pattern = "Gillette and Ray 1981 Smithsonian Institution Press", replacement = "Gillette and Ray 1981 Glyptodonts of North America", x = herbiTraits_Master$Limb.Morphology.Reference)
herbiTraits_Master$Habitat.Reference = gsub(pattern = "Gillette and Ray 1981 Smithsonian Institution Press", replacement = "Gillette and Ray 1981 Glyptodonts of North America", x = herbiTraits_Master$Habitat.Reference)
herbiTraits_Master$Mass.Reference = gsub(pattern = "Kingdon et al. 2013 Mammals of Africa Louys et al. 2011 Journal of Archaeological Science", replacement = "Kingdon et al. 2013 Mammals of Africa; Louys et al. 2011 Journal of Archaeological Science", x = herbiTraits_Master$Mass.Reference)
herbiTraits_Master$Diet.Reference = gsub(pattern = "Kingdon et al. 2013 Mammals of Africa Louys et al. 2011 Journal of Archaeological Science", replacement = "Kingdon et al. 2013 Mammals of Africa; Louys et al. 2011 Journal of Archaeological Science", x = herbiTraits_Master$Diet.Reference)
herbiTraits_Master$Fermentation.Type.Reference = gsub(pattern = "Kingdon et al. 2013 Mammals of Africa Louys et al. 2011 Journal of Archaeological Science", replacement = "Kingdon et al. 2013 Mammals of Africa; Louys et al. 2011 Journal of Archaeological Science", x = herbiTraits_Master$Fermentation.Type.Reference)
herbiTraits_Master$Limb.Morphology.Reference = gsub(pattern = "Kingdon et al. 2013 Mammals of Africa Louys et al. 2011 Journal of Archaeological Science", replacement = "Kingdon et al. 2013 Mammals of Africa; Louys et al. 2011 Journal of Archaeological Science", x = herbiTraits_Master$Limb.Morphology.Reference)
herbiTraits_Master$Habitat.Reference = gsub(pattern = "Kingdon et al. 2013 Mammals of Africa Louys et al. 2011 Journal of Archaeological Science", replacement = "Kingdon et al. 2013 Mammals of Africa; Louys et al. 2011 Journal of Archaeological Science", x = herbiTraits_Master$Habitat.Reference)
herbiTraits_Master$Mass.Reference = gsub(pattern = "Hofreiter et al. 2000 Molecular EcologyGreen 2009 Zoological Journal of the Linnean Society", replacement = "Hofreiter et al. 2000 Molecular Ecology; Green 2009 Zoological Journal of the Linnean Society", x = herbiTraits_Master$Mass.Reference)
herbiTraits_Master$Diet.Reference = gsub(pattern = "Hofreiter et al. 2000 Molecular EcologyGreen 2009 Zoological Journal of the Linnean Society", replacement = "Hofreiter et al. 2000 Molecular Ecology; Green 2009 Zoological Journal of the Linnean Society", x = herbiTraits_Master$Diet.Reference)
herbiTraits_Master$Fermentation.Type.Reference = gsub(pattern = "Hofreiter et al. 2000 Molecular EcologyGreen 2009 Zoological Journal of the Linnean Society", replacement = "Hofreiter et al. 2000 Molecular Ecology; Green 2009 Zoological Journal of the Linnean Society", x = herbiTraits_Master$Fermentation.Type.Reference)
herbiTraits_Master$Limb.Morphology.Reference = gsub(pattern = "Hofreiter et al. 2000 Molecular EcologyGreen 2009 Zoological Journal of the Linnean Society", replacement = "Hofreiter et al. 2000 Molecular Ecology; Green 2009 Zoological Journal of the Linnean Society", x = herbiTraits_Master$Limb.Morphology.Reference)
herbiTraits_Master$Habitat.Reference = gsub(pattern = "Hofreiter et al. 2000 Molecular EcologyGreen 2009 Zoological Journal of the Linnean Society", replacement = "Hofreiter et al. 2000 Molecular Ecology; Green 2009 Zoological Journal of the Linnean Society", x = herbiTraits_Master$Habitat.Reference)
herbiTraits_Master$Mass.Reference = gsub(pattern = "Hollis et al. 1986 Wildlife Research, Osawa 1990 Wildlife Research", replacement = "Hollis et al. 1986 Wildlife Research; Osawa 1990 Wildlife Research", x = herbiTraits_Master$Mass.Reference)
herbiTraits_Master$Diet.Reference = gsub(pattern = "Hollis et al. 1986 Wildlife Research, Osawa 1990 Wildlife Research", replacement = "Hollis et al. 1986 Wildlife Research; Osawa 1990 Wildlife Research", x = herbiTraits_Master$Diet.Reference)
herbiTraits_Master$Fermentation.Type.Reference = gsub(pattern = "Hollis et al. 1986 Wildlife Research, Osawa 1990 Wildlife Research", replacement = "Hollis et al. 1986 Wildlife Research; Osawa 1990 Wildlife Research", x = herbiTraits_Master$Fermentation.Type.Reference)
herbiTraits_Master$Limb.Morphology.Reference = gsub(pattern = "Hollis et al. 1986 Wildlife Research, Osawa 1990 Wildlife Research", replacement = "Hollis et al. 1986 Wildlife Research; Osawa 1990 Wildlife Research", x = herbiTraits_Master$Limb.Morphology.Reference)
herbiTraits_Master$Habitat.Reference = gsub(pattern = "Hollis et al. 1986 Wildlife Research, Osawa 1990 Wildlife Research", replacement = "Hollis et al. 1986 Wildlife Research; Osawa 1990 Wildlife Research", x = herbiTraits_Master$Habitat.Reference)
herbiTraits_Master$Mass.Reference = gsub(pattern = "Syed and Ilyas 2015 Animal Production Science;Bhattacharya et al. 2012 Proceedings of the Zoological Society", replacement = "Syed and Ilyas 2015 Animal Production Science; Bhattacharya et al. 2012 Proceedings of the Zoological Society", x = herbiTraits_Master$Mass.Reference)
herbiTraits_Master$Diet.Reference = gsub(pattern = "Syed and Ilyas 2015 Animal Production Science;Bhattacharya et al. 2012 Proceedings of the Zoological Society", replacement = "Syed and Ilyas 2015 Animal Production Science; Bhattacharya et al. 2012 Proceedings of the Zoological Society", x = herbiTraits_Master$Diet.Reference)
herbiTraits_Master$Fermentation.Type.Reference = gsub(pattern = "Syed and Ilyas 2015 Animal Production Science;Bhattacharya et al. 2012 Proceedings of the Zoological Society", replacement = "Syed and Ilyas 2015 Animal Production Science; Bhattacharya et al. 2012 Proceedings of the Zoological Society", x = herbiTraits_Master$Fermentation.Type.Reference)
herbiTraits_Master$Limb.Morphology.Reference = gsub(pattern = "Syed and Ilyas 2015 Animal Production Science;Bhattacharya et al. 2012 Proceedings of the Zoological Society", replacement = "Syed and Ilyas 2015 Animal Production Science; Bhattacharya et al. 2012 Proceedings of the Zoological Society", x = herbiTraits_Master$Limb.Morphology.Reference)
herbiTraits_Master$Habitat.Reference = gsub(pattern = "Syed and Ilyas 2015 Animal Production Science;Bhattacharya et al. 2012 Proceedings of the Zoological Society", replacement = "Syed and Ilyas 2015 Animal Production Science; Bhattacharya et al. 2012 Proceedings of the Zoological Society", x = herbiTraits_Master$Habitat.Reference)
herbiTraits_Master$Mass.Reference = gsub(pattern = "Wilman et al. 2014 Ecology;Avaliani et al. 2007", replacement = "Wilman et al. 2014 Ecology; Avaliani et al. 2007", x = herbiTraits_Master$Mass.Reference)
herbiTraits_Master$Diet.Reference = gsub(pattern = "Wilman et al. 2014 Ecology;Avaliani et al. 2007", replacement = "Wilman et al. 2014 Ecology; Avaliani et al. 2007", x = herbiTraits_Master$Diet.Reference)
herbiTraits_Master$Fermentation.Type.Reference = gsub(pattern = "Wilman et al. 2014 Ecology;Avaliani et al. 2007", replacement = "Wilman et al. 2014 Ecology; Avaliani et al. 2007", x = herbiTraits_Master$Fermentation.Type.Reference)
herbiTraits_Master$Limb.Morphology.Reference = gsub(pattern = "Wilman et al. 2014 Ecology;Avaliani et al. 2007", replacement = "Wilman et al. 2014 Ecology; Avaliani et al. 2007", x = herbiTraits_Master$Limb.Morphology.Reference)
herbiTraits_Master$Habitat.Reference = gsub(pattern = "Wilman et al. 2014 Ecology;Avaliani et al. 2007", replacement = "Wilman et al. 2014 Ecology; Avaliani et al. 2007", x = herbiTraits_Master$Habitat.Reference)
herbiTraits_Master$Mass.Reference = gsub(pattern = "Madden 2014 Cambridge University Press", replacement = "Madden 2014 Hypsodonty in Mammals: Evolution, Geomorphology, and the Role of Earth System Processes", x = herbiTraits_Master$Mass.Reference)
herbiTraits_Master$Diet.Reference = gsub(pattern = "Madden 2014 Cambridge University Press", replacement = "Madden 2014 Hypsodonty in Mammals: Evolution, Geomorphology, and the Role of Earth System Processes", x = herbiTraits_Master$Diet.Reference)
herbiTraits_Master$Fermentation.Type.Reference = gsub(pattern = "Madden 2014 Cambridge University Press", replacement = "Madden 2014 Hypsodonty in Mammals: Evolution, Geomorphology, and the Role of Earth System Processes", x = herbiTraits_Master$Fermentation.Type.Reference)
herbiTraits_Master$Limb.Morphology.Reference = gsub(pattern = "Madden 2014 Cambridge University Press", replacement = "Madden 2014 Hypsodonty in Mammals: Evolution, Geomorphology, and the Role of Earth System Processes", x = herbiTraits_Master$Limb.Morphology.Reference)
herbiTraits_Master$Habitat.Reference = gsub(pattern = "Madden 2014 Cambridge University Press", replacement = "Madden 2014 Hypsodonty in Mammals: Evolution, Geomorphology, and the Role of Earth System Processes", x = herbiTraits_Master$Habitat.Reference)
herbiTraits_Master$Mass.Reference = gsub(pattern = "NA Lobo 2015 Thesis", replacement = "Lobo 2015 Thesis", x = herbiTraits_Master$Mass.Reference)
herbiTraits_Master$Diet.Reference = gsub(pattern = "NA Lobo 2015 Thesis", replacement = "Lobo 2015 Thesis", x = herbiTraits_Master$Diet.Reference)
herbiTraits_Master$Fermentation.Type.Reference = gsub(pattern = "NA Lobo 2015 Thesis", replacement = "Lobo 2015 Thesis", x = herbiTraits_Master$Fermentation.Type.Reference)
herbiTraits_Master$Limb.Morphology.Reference = gsub(pattern = "NA Lobo 2015 Thesis", replacement = "Lobo 2015 Thesis", x = herbiTraits_Master$Limb.Morphology.Reference)
herbiTraits_Master$Habitat.Reference = gsub(pattern = "NA Lobo 2015 Thesis", replacement = "Lobo 2015 Thesis", x = herbiTraits_Master$Habitat.Reference)
herbiTraits_Master$Mass.Reference = gsub(pattern = "Prideaux 2009 Proceedings of the National Academy of Sciences of the United States of America", replacement = "Prideaux et al. 2009 Proceedings of the National Academy of Sciences of the United States of America", x = herbiTraits_Master$Mass.Reference)
herbiTraits_Master$Diet.Reference = gsub(pattern = "Prideaux 2009 Proceedings of the National Academy of Sciences of the United States of America", replacement = "Prideaux et al. 2009 Proceedings of the National Academy of Sciences of the United States of America", x = herbiTraits_Master$Diet.Reference)
herbiTraits_Master$Fermentation.Type.Reference = gsub(pattern = "Prideaux 2009 Proceedings of the National Academy of Sciences of the United States of America", replacement = "Prideaux et al. 2009 Proceedings of the National Academy of Sciences of the United States of America", x = herbiTraits_Master$Fermentation.Type.Reference)
herbiTraits_Master$Limb.Morphology.Reference = gsub(pattern = "Prideaux 2009 Proceedings of the National Academy of Sciences of the United States of America", replacement = "Prideaux et al. 2009 Proceedings of the National Academy of Sciences of the United States of America", x = herbiTraits_Master$Limb.Morphology.Reference)
herbiTraits_Master$Habitat.Reference = gsub(pattern = "Prideaux 2009 Proceedings of the National Academy of Sciences of the United States of America", replacement = "Prideaux et al. 2009 Proceedings of the National Academy of Sciences of the United States of America", x = herbiTraits_Master$Habitat.Reference)
herbiTraits_Master$Mass.Reference = gsub(pattern = "Torres et al. 2018 Proc B", replacement = "Torres et al. 2018 Proceedings of the Royal Society B", x = herbiTraits_Master$Mass.Reference)
herbiTraits_Master$Diet.Reference = gsub(pattern = "Torres et al. 2018 Proc B", replacement = "Torres et al. 2018 Proceedings of the Royal Society B", x = herbiTraits_Master$Diet.Reference)
herbiTraits_Master$Fermentation.Type.Reference = gsub(pattern = "Torres et al. 2018 Proc B", replacement = "Torres et al. 2018 Proceedings of the Royal Society B", x = herbiTraits_Master$Fermentation.Type.Reference)
herbiTraits_Master$Limb.Morphology.Reference = gsub(pattern = "Torres et al. 2018 Proc B", replacement = "Torres et al. 2018 Proceedings of the Royal Society B", x = herbiTraits_Master$Limb.Morphology.Reference)
herbiTraits_Master$Habitat.Reference = gsub(pattern = "Torres et al. 2018 Proc B", replacement = "Torres et al. 2018 Proceedings of the Royal Society B", x = herbiTraits_Master$Habitat.Reference)
#–––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––####
##### 4. SAVE DATA  #####
#–––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––––####
## Create filename
date = as.Date(Sys.time()) # Create Date
date = gsub("-","_",date)
filename = paste("./HerbiTraits_2020_10_01/Changes/3_Output/HerbiTraits_S3_",date,".csv", sep ="") #Create filename
## Save
write.csv(herbiTraits_Master, file = filename, row.names = F)
```{r, include = F}
getwd()
```
# Introduction
HerbiTraits is a functional trait dataset that contains functional traits of all large-bodied (≥10 kg), terrestrial, avian and mammalian herbivores that lived during the last 130,000 years (n = 545 species). The mammalian component of the dataset is based on PHYLACINE V1.2 taxonomy and root traits, but we have provided more detailed trait information for the species of interest. The avian component has been added by the authors of HerbiTraits. HerbiTraits includes data on:
```{r, results = 'hide', include = F}
## Working Directory
getwd()
```
# Introduction
HerbiTraits is a functional trait dataset that contains functional traits of all large-bodied (≥10 kg), terrestrial, avian and mammalian herbivores that lived during the last 130,000 years (n = 545 species). The mammalian component of the dataset is based on PHYLACINE V1.2 taxonomy and root traits, but we have provided more detailed trait information for the species of interest. The avian component has been added by the authors of HerbiTraits. HerbiTraits includes data on:
